<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>模板</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../../lib/layui/css/layui.css" media="all"/>
    <style type="text/css">
        .layui-form-item .layui-inline {
            width: 33.333%;
            float: left;
            margin-right: 0;
        }

        @media (max-width: 1240px) {
            .layui-form-item .layui-inline {
                width: 100%;
                float: none;
            }
        }
    </style>
</head>
<body class="childrenBody">
<form class="layui-form" style="width:80%;">
<!--    <div class="layui-form-item">-->
<!--        <div class="layui-input-block">-->
<!--            <button class="layui-btn" lay-submit="" lay-filter="addUser">发布</button>-->
<!--            <button type="reset" class="layui-btn layui-btn-primary">重置</button>-->
<!--        </div>-->
<!--    </div>-->
<!--    //lay-filter="addUser"-->
    <div class="layui-inline">
        <a class="layui-btn layui-btn-normal add_Vote" align="right" lay-submit="" lay-filter="addVote">发布</a>
        <a class="layui-btn layui-btn-normal add_btn" lay-submit="" lay-filter="addModel" align="right">存入模板</a>
        <a class="layui-btn layui-btn-normal add_btn" align="right" lay-submit="" lay-filter="yulan">预览</a>
    </div>
    <div class="layui-form-item parent-menu">
        <label class="layui-form-label">标题</label>
        <div id="title1" class="layui-input-block">
            <input type="text" class="layui-input"  name="title" placeholder="请输入标题">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">投票说明</label>
        <div id="title2" class="layui-input-block">
            <input type="text" class="layui-input" name="votingInstruction" placeholder="请输入题目">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">投票人数</label>
        <div id="title3" class="layui-input-block">
            <input type="text" class="layui-input" name="votedNum" placeholder="请输入题目">
        </div>
    </div>
    <div id="gradfather">
    <div id="add">
    <div class="layui-form-item">
        <label class="layui-form-label">题目1</label>
        <div class="layui-input-block">
            <input type="text" class="layui-input" name="content" placeholder="请输入题目">
        </div>
    </div>
        <div class="layui-upload">
            <button type="button" class="layui-btn" id="test2" data-id="demo2">多图片上传</button>
            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                预览图：
                <div class="layui-upload-list" id="demo2"></div>
            </blockquote>
        </div>
<!--        <div class="layui-inline">-->
<!--            <a class="layui-btn layui-btn-normal addphoto"  align="right">图片选择</a>-->
<!--        </div>-->
        <div  class="layui-input-block">
            <label class="layui-form-label">选项规则</label>
            <input type="radio" class="layui-input"  name="optionRule" value="单选" title="单选" checked="checked">
            <input type="radio" class="layui-input"  name="optionRule" value="多选" title="多选">
    </div>
    <div class="father">
    <div class="layui-form-item">
        <label class="layui-form-label">子标准1</label>
        <div class="layui-input-block">
            <input type="text" class="layui-input"  name="answer"  placeholder="选项答案">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">子标准2</label>
        <div class="layui-input-block">
            <input type="text" class="layui-input"  name="answer"  placeholder="选项答案">
        </div>
    </div>
    </div>
    <button type="button" id="append" class="layui-btn layui-btn-primary" onclick="zAppend($(this));">添加子标准</button>
    </div>
    <button type="button" id="appendmore" class="layui-btn layui-btn-primary appendmore" >添加题目内容</button>
    </div>
    <button class="layui-btn layui-btn-primary appendmore" onclick="huoqu()">获取数据</button>

</form>

<!--一般情况下，一个业务页面引入一个layui.js,config.js和业务js这三个js就够了-->
<script type="text/javascript" src="../../../lib/layui/layui.js"></script>
<script type="text/javascript" src="../../../common/js/config.js"></script>
<script type="text/javascript" src="vote.js"></script>
<script type="text/javascript" src="../../../lib/jquery-2.2.4/jquery.js"></script>
<script type="text/javascript">
    function huoqu() {

        var a = $("#title1 input").val();//标题
        var b = $("#title2 input").val();//投票说明
        var c = $("#title3 input").val();//投票人数
        var title = $("#gradfather").children("div");
        var bz_jihe = [];
        for (var i = 0; i < title.length; i++) {

            var d = $($($($(title[i]).children(".layui-form-item")[0]).children("div")[0]).children("input")[0]).val();
            //题目


            var choose = $($($(title[i]).children(".layui-input-block")[0]).children("input")[0]).is(":checked");
            //选项规则
            // alert(choose);
            var die = $($(title[i]).children(".father")[0]);
            var answer = die.children(".layui-form-item");
            var zbz_jihe = [];
            for (var j = 0; j < answer.length; j++) {
                var e = $($($(answer[j]).children(".layui-input-block")[0]).children("input")[0]).val();
                //子标准 答案
                // alert(e);
                zbz_jihe.push(e);
            }
            var bz_obj = {d: d, choose: choose, zbz_jihe: zbz_jihe};
            bz_jihe.push(bz_obj);
        }
        var data = {a: a, b: b, c: c, bz_jihe: bz_jihe};

        alert(JSON.stringify(data));
        // console.log(a,b,c);
        // $($($($("#father").children(".layui-form-item")[0]).children(".layui-input-block")[0]).children("input")[0]).val();//取子标准

        // $.ajax({
        //     data:1,
        //     type : 'POST',
        //     url : $tool.getContext() +'Vote/voteadd.do/',//（1）请求的action路径,可以传递参数到后台
        //     error : function() {
        //         alert('请求失败 ');
        //     },
        //     success : function(data) {
        //         alert(data);
        //     }
        //
        // });
    }
    var index = 2;
    // var maxfile=2;
    // var items = [2];//表示每一题最大选项
    function zAppend(a){
        var id =$($(a.prev()).children()).length +1;
        $(a.prev()).append("<div class=\"layui-form-item\">\n" +
            '        <label class="layui-form-label">子标准'+id+'</label>' +
            "        <div class=\"layui-input-block\">\n" +
            "            <input type=\"text\" class=\"layui-input\"  name=\"answer\"  placeholder=\"选项答案\">\n" +
            "        </div>\n" +
            "    </div>");

        var zbz = '';
        for(var i =0;i<item.length;i++){
            zbz += '<div class="zbz"></div>';
        }
        var bz = '<div class="bz"><div class="zbzColl">'+zbz+'</div></div>';
    }



</script>

</body>
</html>